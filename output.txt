/home/j/s/jsdb/.local/lib/python2.7/site-packages/pkg_resources/py2_warn.py:21: UserWarning: Setuptools will stop working on Python 2
************************************************************
You are running Setuptools on Python 2, which is no longer
supported and
>>> SETUPTOOLS WILL STOP WORKING <<<
in a subsequent release (no sooner than 2020-04-20).
Please ensure you are installing
Setuptools using pip 9.x or later or pin to `setuptools<45`
in your environment.
If you have done those things and are still encountering
this message, please follow up at
https://bit.ly/setuptools-py2-warning.
************************************************************
  sys.version_info < (3,) and warnings.warn(pre + "*" * 60 + msg + "*" * 60)
Reading: data/modif_data/ppi_mini.csv
Edges: 6623
Nodes: 4505
Reading: data/modif_data/mono_mini.csv
Number of individual side effects:  575
Reading: data/modif_data/target_mini.csv
Reading: data/modif_data/combo_mini.csv
Drug combinations: 29741 Side effects: 20
Drug-drug interactions: 53382
Number of drugs:  607
Defining placeholders
Create minibatch iterator
Minibatch edge type: (0, 1, 0)
Constructing test edges= 0000/0845
Constructing val edges= 0000/0845
Train edges= 15219
Val edges= 0845
Test edges= 0845
Minibatch edge type: (1, 0, 0)
Constructing test edges= 0000/0845
Constructing val edges= 0000/0845
Train edges= 15219
Val edges= 0845
Test edges= 0845
Minibatch edge type: (0, 0, 0)
Constructing test edges= 0000/0662
Constructing val edges= 0000/0662
Train edges= 11922
Val edges= 0662
Test edges= 0662
Minibatch edge type: (0, 0, 1)
Constructing test edges= 0000/0662
Constructing val edges= 0000/0662
Train edges= 11922
Val edges= 0662
Test edges= 0662
Minibatch edge type: (1, 1, 0)
Constructing test edges= 0000/0054
Constructing val edges= 0000/0054
Train edges= 0980
Val edges= 0054
Test edges= 0054
Minibatch edge type: (1, 1, 1)
Constructing test edges= 0000/0060
Constructing val edges= 0000/0060
Train edges= 1080
Val edges= 0060
Test edges= 0060
Minibatch edge type: (1, 1, 2)
Constructing test edges= 0000/0307
Constructing val edges= 0000/0307
Train edges= 5533
Val edges= 0307
Test edges= 0307
Minibatch edge type: (1, 1, 3)
Constructing test edges= 0000/0003
Constructing val edges= 0000/0020
Train edges= 0000
Val edges= 0020
Test edges= 0003
Minibatch edge type: (1, 1, 4)
Constructing test edges= 0000/0330
Constructing val edges= 0000/0330
Train edges= 5956
Val edges= 0330
Test edges= 0330
Minibatch edge type: (1, 1, 5)
Constructing test edges= 0000/0281
Constructing val edges= 0000/0281
Train edges= 5066
Val edges= 0281
Test edges= 0281
Minibatch edge type: (1, 1, 6)
Constructing test edges= 0000/0022
Constructing val edges= 0000/0022
Train edges= 0405
Val edges= 0022
Test edges= 0022
Minibatch edge type: (1, 1, 7)
Constructing test edges= 0000/0096
Constructing val edges= 0000/0096
Train edges= 1740
Val edges= 0096
Test edges= 0096
Minibatch edge type: (1, 1, 8)
Constructing test edges= 0000/0020
Constructing val edges= 0000/0020
Train edges= 0232
Val edges= 0020
Test edges= 0020
Minibatch edge type: (1, 1, 9)
Constructing test edges= 0000/0020
Constructing val edges= 0000/0020
Train edges= 0130
Val edges= 0020
Test edges= 0020
Minibatch edge type: (1, 1, 10)
Constructing test edges= 0000/0771
Constructing val edges= 0000/0771
Train edges= 13888
Val edges= 0771
Test edges= 0771
Minibatch edge type: (1, 1, 11)
Constructing test edges= 0000/0181
Constructing val edges= 0000/0181
Train edges= 3272
Val edges= 0181
Test edges= 0181
Minibatch edge type: (1, 1, 12)
Constructing test edges= 0000/0032
Constructing val edges= 0000/0032
Train edges= 0589
Val edges= 0032
Test edges= 0032
Minibatch edge type: (1, 1, 13)
Constructing test edges= 0000/0020
Constructing val edges= 0000/0020
Train edges= 0024
Val edges= 0020
Test edges= 0020
Minibatch edge type: (1, 1, 14)
Constructing test edges= 0000/0160
Constructing val edges= 0000/0160
Train edges= 2889
Val edges= 0160
Test edges= 0160
Minibatch edge type: (1, 1, 15)
Constructing test edges= 0000/0078
Constructing val edges= 0000/0078
Train edges= 1404
Val edges= 0078
Test edges= 0078
Minibatch edge type: (1, 1, 16)
Constructing test edges= 0000/0027
Constructing val edges= 0000/0027
Train edges= 0502
Val edges= 0027
Test edges= 0027
Minibatch edge type: (1, 1, 17)
Constructing test edges= 0000/0020
Constructing val edges= 0000/0020
Train edges= 0193
Val edges= 0020
Test edges= 0020
Minibatch edge type: (1, 1, 18)
Constructing test edges= 0000/0221
Constructing val edges= 0000/0221
Train edges= 3987
Val edges= 0221
Test edges= 0221
Minibatch edge type: (1, 1, 19)
Constructing test edges= 0000/0020
Constructing val edges= 0000/0020
Train edges= 0049
Val edges= 0020
Test edges= 0020
Minibatch edge type: (1, 1, 20)
Constructing test edges= 0000/0054
Constructing val edges= 00WARNING:tensorflow:From /afs/kth.se/home/j/s/jsdb/Documents/Master-Thesis/decagon/deep/layers.py:93: calling l2_normalize (from tensorflow.python.ops.nn_impl) with dim is deprecated and will be removed in a future version.
Instructions for updating:
dim is deprecated, use axis instead
WARNING:tensorflow:tf.op_scope(values, name, default_name) is deprecated, use tf.name_scope(name, default_name, values)
WARNING:tensorflow:tf.op_scope(values, name, default_name) is deprecated, use tf.name_scope(name, default_name, values)
/home/j/s/jsdb/.local/lib/python2.7/site-packages/tensorflow/python/ops/gradients_impl.py:100: UserWarning: Converting sparse IndexedSlices to a dense Tensor of unknown shape. This may consume a large amount of memory.
  "Converting sparse IndexedSlices to a dense Tensor of unknown shape. "
2020-04-28 18:26:38.973453: I tensorflow/core/platform/cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
00/0054
Train edges= 0980
Val edges= 0054
Test edges= 0054
Minibatch edge type: (1, 1, 21)
Constructing test edges= 0000/0060
Constructing val edges= 0000/0060
Train edges= 1080
Val edges= 0060
Test edges= 0060
Minibatch edge type: (1, 1, 22)
Constructing test edges= 0000/0307
Constructing val edges= 0000/0307
Train edges= 5533
Val edges= 0307
Test edges= 0307
Minibatch edge type: (1, 1, 23)
Constructing test edges= 0000/0003
Constructing val edges= 0000/0020
Train edges= 0000
Val edges= 0020
Test edges= 0003
Minibatch edge type: (1, 1, 24)
Constructing test edges= 0000/0330
Constructing val edges= 0000/0330
Train edges= 5956
Val edges= 0330
Test edges= 0330
Minibatch edge type: (1, 1, 25)
Constructing test edges= 0000/0281
Constructing val edges= 0000/0281
Train edges= 5066
Val edges= 0281
Test edges= 0281
Minibatch edge type: (1, 1, 26)
Constructing test edges= 0000/0022
Constructing val edges= 0000/0022
Train edges= 0405
Val edges= 0022
Test edges= 0022
Minibatch edge type: (1, 1, 27)
Constructing test edges= 0000/0096
Constructing val edges= 0000/0096
Train edges= 1740
Val edges= 0096
Test edges= 0096
Minibatch edge type: (1, 1, 28)
Constructing test edges= 0000/0020
Constructing val edges= 0000/0020
Train edges= 0232
Val edges= 0020
Test edges= 0020
Minibatch edge type: (1, 1, 29)
Constructing test edges= 0000/0020
Constructing val edges= 0000/0020
Train edges= 0130
Val edges= 0020
Test edges= 0020
Minibatch edge type: (1, 1, 30)
Constructing test edges= 0000/0771
Constructing val edges= 0000/0771
Train edges= 13888
Val edges= 0771
Test edges= 0771
Minibatch edge type: (1, 1, 31)
Constructing test edges= 0000/0181
Constructing val edges= 0000/0181
Train edges= 3272
Val edges= 0181
Test edges= 0181
Minibatch edge type: (1, 1, 32)
Constructing test edges= 0000/0032
Constructing val edges= 0000/0032
Train edges= 0589
Val edges= 0032
Test edges= 0032
Minibatch edge type: (1, 1, 33)
Constructing test edges= 0000/0020
Constructing val edges= 0000/0020
Train edges= 0024
Val edges= 0020
Test edges= 0020
Minibatch edge type: (1, 1, 34)
Constructing test edges= 0000/0160
Constructing val edges= 0000/0160
Train edges= 2889
Val edges= 0160
Test edges= 0160
Minibatch edge type: (1, 1, 35)
Constructing test edges= 0000/0078
Constructing val edges= 0000/0078
Train edges= 1404
Val edges= 0078
Test edges= 0078
Minibatch edge type: (1, 1, 36)
Constructing test edges= 0000/0027
Constructing val edges= 0000/0027
Train edges= 0502
Val edges= 0027
Test edges= 0027
Minibatch edge type: (1, 1, 37)
Constructing test edges= 0000/0020
Constructing val edges= 0000/0020
Train edges= 0193
Val edges= 0020
Test edges= 0020
Minibatch edge type: (1, 1, 38)
Constructing test edges= 0000/0221
Constructing val edges= 0000/0221
Train edges= 3987
Val edges= 0221
Test edges= 0221
Minibatch edge type: (1, 1, 39)
Constructing test edges= 0000/0020
Constructing val edges= 0000/0020
Train edges= 0049
Val edges= 0020
Test edges= 0020
Create model
Create optimizer
Initialize session
Train model
Epoch: 0001 Iter: 0001 Edge: 0002 train_loss= 731.68530 val_roc= 0.57039 val_auprc= 0.55969 val_apk= 0.36211 time= 3.77830
Epoch: 0001 Iter: 0151 Edge: 0001 train_loss= 160.01366 val_roc= 0.95668 val_auprc= 0.96176 val_apk= 1.00000 time= 0.26645
Epoch: 0001 Iter: 0301 Edge: 0002 train_loss= 480.15405 val_roc= 0.88